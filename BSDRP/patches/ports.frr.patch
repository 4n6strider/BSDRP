Index: net/frr/Makefile
===================================================================
--- net/frr/Makefile	(revision 451977)
+++ net/frr/Makefile	(working copy)
@@ -1,7 +1,7 @@
 # $FreeBSD$
 
 PORTNAME=	frr
-PORTVERSION=	2.0
+PORTVERSION=	3.0
 CATEGORIES=	net ipv6
 
 MAINTAINER=	olivier@FreeBSD.org
@@ -18,11 +18,11 @@
 USE_GITHUB=	yes
 GH_ACCOUNT=	FRRouting
 GH_PROJECT=	frr
-GH_TAGNAME=	frr-2.0
+GH_TAGNAME=	frr-3.0
 
 GNU_CONFIGURE=	yes
 INSTALL_TARGET=	install-strip
-USES=		autoreconf gmake pkgconfig libtool makeinfo readline
+USES=		autoreconf bison gmake pkgconfig libtool makeinfo readline
 USE_LDCONFIG=	yes
 
 INFO=		frr
@@ -36,12 +36,12 @@
 # IRDP option needs something freebsd does not seem to have:
 # configure: error: 'IRDP requires in_pktinfo at the moment!'
 
-FPM_DESC= 		Enable Forwarding Plane Manager support
+FPM_DESC=		Enable Forwarding Plane Manager support
 LDPD_DESC=		Build ldpd
 MULTIPATH_DESC=		Enable multipath function
 PAM_DESC=		Use libpam for PAM support in vtysh
 SHELLACCESS_DESC=	Allow users to access shell/telnet/ssh
-SNMP_DESC= 		SNMP support
+SNMP_DESC=		SNMP support
 TCMALLOC_DESC=		Use tcmalloc
 TCPSOCKETS_DESC=	Use TCP/IP sockets for protocol daemons
 VTYSH_DESC=		Build integrated vty shell
Index: net/frr/distinfo
===================================================================
--- net/frr/distinfo	(revision 451977)
+++ net/frr/distinfo	(working copy)
@@ -1,3 +1,3 @@
-TIMESTAMP = 1497785263
-SHA256 (FRRouting-frr-2.0-frr-2.0_GH0.tar.gz) = 70259dc379678a7b0c32abd30173034f31876612451e2ffd7d09c52ab22ac05b
-SIZE (FRRouting-frr-2.0-frr-2.0_GH0.tar.gz) = 3025536
+TIMESTAMP = 1508142178
+SHA256 (FRRouting-frr-3.0-frr-3.0_GH0.tar.gz) = 9335c83c2c0a21e64b4e64a130ee95c1f90d76103cff05e816f452a8ba0603d9
+SIZE (FRRouting-frr-3.0-frr-3.0_GH0.tar.gz) = 3166434
Index: net/frr/files/frr.in
===================================================================
--- net/frr/files/frr.in	(revision 451977)
+++ net/frr/files/frr.in	(working copy)
@@ -5,7 +5,7 @@
 
 # PROVIDE: frr
 # REQUIRE: netif routing 
-# KEYWORD: nojail shutdown
+# KEYWORD: nojailvnet shutdown
 
 # Add the following line to /etc/rc.conf to enable frr:
 #  frr_enable="YES"
@@ -78,7 +78,7 @@
 		echo Waiting for ${frr_wait_for} route...
 		while [ ${waited_for} -lt ${frr_wait_seconds} ]; do
 			/sbin/route -n get ${frr_wait_for} >/dev/null 2>&1 && break;
-			waited_for=$((${waited_for}+1))
+			waited_for=$((waited_for+1))
 			sleep 1;
 		done
 		[ ${waited_for} -lt ${frr_wait_seconds} ] || echo Giving up...
@@ -93,13 +93,13 @@
 	    command=%%PREFIX%%/sbin/${daemon}
 	    required_files=%%ETCDIR%%/${daemon}.conf
 	    pidfile=/var/run/frr/${daemon}.pid
-	    if [ ${frr_cmd} = "restart" -o ${frr_cmd} = "start" ]; then
+	    if [ ${frr_cmd} = "restart" ] || [ ${frr_cmd} = "start" ]; then
 		check_config
 	    fi
-	    if [ ${frr_cmd} = "start" -a ! -f ${required_files} ]; then
+	    if [ ${frr_cmd} = "start" ] && ![ -f ${required_files} ]; then
 			continue
 	    fi
-	    if [ ${frr_cmd} = "stop" -a -z $(check_process ${command}) ]; then
+	    if [ ${frr_cmd} = "stop" ] && [ -z $(check_process ${command}) ]; then
 			continue
 	    fi
 	    eval flags=\$\{${daemon}_flags:-\"${frr_flags}\"\}
Index: net/frr/files/patch-Makefile.am
===================================================================
--- net/frr/files/patch-Makefile.am	(revision 451977)
+++ net/frr/files/patch-Makefile.am	(working copy)
@@ -1,9 +1,9 @@
---- Makefile.am.orig	2017-04-02 05:22:47 UTC
+--- Makefile.am.orig	2017-03-08 14:59:07 UTC
 +++ Makefile.am
-@@ -3,7 +3,7 @@
- SUBDIRS = lib qpb fpm @ZEBRA@ @LIBRFP@ @RFPTEST@ \
+@@ -4,7 +4,7 @@ SUBDIRS = lib qpb fpm @ZEBRA@ @LIBRFP@ @RFPTEST@ \
  	 @BGPD@ @RIPD@ @RIPNGD@ @OSPFD@ @OSPF6D@ @LDPD@ \
-          @ISISD@ @PIMD@ @WATCHFRR@ @VTYSH@ @OSPFCLIENT@ @DOC@ m4 @pkgsrcdir@ \
+          @ISISD@ @PIMD@ @NHRPD@ \
+ 	 @WATCHFRR@ @VTYSH@ @OSPFCLIENT@ @DOC@ m4 @pkgsrcdir@ \
 -         redhat @SOLARIS@ tests tools cumulus snapcraft
 +         redhat @SOLARIS@ tests cumulus snapcraft
  
Index: net/frr/files/patch-vtysh_vtysh.c
===================================================================
--- net/frr/files/patch-vtysh_vtysh.c	(revision 451977)
+++ net/frr/files/patch-vtysh_vtysh.c	(working copy)
@@ -1,11 +1,11 @@
---- vtysh/vtysh.c.orig	2017-06-27 14:48:26 UTC
-+++ vtysh/vtysh.c
-@@ -261,7 +261,7 @@ vtysh_pager_init (void)
-   if (pager_defined)
-     vtysh_pager_name = strdup (pager_defined);
-   else
--    vtysh_pager_name = strdup ("more");
-+    vtysh_pager_name = strdup ("cat");
+--- vtysh/vtysh.c.orig	2017-08-09 12:56:09.000000000 +0200
++++ vtysh/vtysh.c	2017-08-22 22:04:36.068181000 +0200
+@@ -249,7 +249,7 @@
+ 	if (pager_defined)
+ 		vtysh_pager_name = strdup(pager_defined);
+ 	else
+-		vtysh_pager_name = strdup("more");
++		vtysh_pager_name = strdup("cat");
  }
  
  /* Command execution over the vty interface. */
Index: net/frr/files/watchfrr.in
===================================================================
--- net/frr/files/watchfrr.in	(revision 451977)
+++ net/frr/files/watchfrr.in	(working copy)
@@ -5,13 +5,13 @@
 
 # PROVIDE: watchfrr
 # REQUIRE: NETWORKING frr
-# KEYWORD: shutdown
+# KEYWORD: nojailvtnet shutdown
 
 # Add the following line to /etc/rc.conf to enable watchfrr:
 # watchfrr_enable="YES"
 #
 # You may also wish to use the following variables to fine-tune startup:
-# watchquagga_flags
+# watchfrr_flags
 
 . /etc/rc.subr
 
Index: net/frr/pkg-plist
===================================================================
--- net/frr/pkg-plist	(revision 451977)
+++ net/frr/pkg-plist	(working copy)
@@ -5,6 +5,7 @@
 include/frr/buffer.h
 include/frr/checksum.h
 include/frr/command.h
+include/frr/command_match.h
 include/frr/csv.h
 include/frr/distribute.h
 include/frr/event_counter.h
@@ -11,7 +12,9 @@
 include/frr/fifo.h
 include/frr/filter.h
 include/frr/getopt.h
+include/frr/graph.h
 include/frr/hash.h
+include/frr/hook.h
 include/frr/if.h
 include/frr/if_rmap.h
 include/frr/imsg.h
@@ -18,6 +21,7 @@
 include/frr/jhash.h
 include/frr/json.h
 include/frr/keychain.h
+include/frr/libfrr.h
 include/frr/libospf.h
 include/frr/linklist.h
 include/frr/log.h
@@ -24,6 +28,8 @@
 include/frr/md5.h
 include/frr/memory.h
 include/frr/memory_vty.h
+include/frr/module.h
+include/frr/monotime.h
 include/frr/mpls.h
 include/frr/network.h
 include/frr/nexthop.h
@@ -46,14 +52,17 @@
 include/frr/prefix.h
 include/frr/privs.h
 include/frr/ptm_lib.h
+include/frr/pw.h
 include/frr/qobj.h
 include/frr/route_types.h
 include/frr/routemap.h
 include/frr/sigevent.h
+include/frr/spf_backoff.h
 include/frr/skiplist.h
 include/frr/smux.h
 include/frr/sockopt.h
 include/frr/sockunion.h
+include/frr/srcdest_table.h
 include/frr/stream.h
 include/frr/systemd.h
 include/frr/table.h
@@ -62,6 +71,7 @@
 include/frr/version.h
 include/frr/vrf.h
 include/frr/vty.h
+include/frr/wheel.h
 include/frr/workqueue.h
 include/frr/zassert.h
 include/frr/zclient.h
@@ -70,14 +80,6 @@
 lib/libfrr.so
 lib/libfrr.so.0
 lib/libfrr.so.0.0.0
-lib/libfrr_pb.a
-lib/libfrr_pb.so
-lib/libfrr_pb.so.0
-lib/libfrr_pb.so.0.0.0
-lib/libfrrfpm_pb.a
-lib/libfrrfpm_pb.so
-lib/libfrrfpm_pb.so.0
-lib/libfrrfpm_pb.so.0.0.0
 lib/libfrrospfapiclient.a
 lib/libfrrospfapiclient.so
 lib/libfrrospfapiclient.so.0
