Index: security/snort/Makefile
===================================================================
--- security/snort/Makefile	(revision 402673)
+++ security/snort/Makefile	(working copy)
@@ -2,7 +2,7 @@
 # $FreeBSD$
 
 PORTNAME=	snort
-PORTVERSION=	2.9.7.6
+PORTVERSION=	2.9.8.0
 CATEGORIES=	security
 MASTER_SITES=	https://snort.org/downloads/snort/ \
 		http://mirrors.rit.edu/zi/
@@ -100,7 +100,7 @@
 LIBNET_LIBDIR=	${LIBNET_LIBS:M-L*:S/-L//}
 
 CFLAGS+=	-fstack-protector
-CONFIGURE_ARGS+=--enable-reload \
+CONFIGURE_ARGS+=--enable-reload --enable-pthread \
 		--enable-mpls --enable-targetbased \
 		--enable-reload-error-restart \
 		--with-dnet-includes=${LIBNET_INCDIR} \
Index: security/snort/distinfo
===================================================================
--- security/snort/distinfo	(revision 402673)
+++ security/snort/distinfo	(working copy)
@@ -1,2 +1,2 @@
-SHA256 (snort-2.9.7.6.tar.gz) = 842e8575e26d919a9e74b9ad0c10d1098f7b5ff2189a8422eb51a9a5b6ebbf63
-SIZE (snort-2.9.7.5.tar.gz) = 6198052
+SHA256 (snort-2.9.8.0.tar.gz) = bddd5d01d10d20c182836fa0199cd3549239b7a9d0fd5bbb10226feb8b42d231
+SIZE (snort-2.9.8.0.tar.gz) = 6323095
Index: security/snort/pkg-plist
===================================================================
--- security/snort/pkg-plist	(revision 402673)
+++ security/snort/pkg-plist	(working copy)
@@ -1,4 +1,4 @@
-%%FILEINSPECT%%bin/file_server
+@comment $FreeBSD$
 bin/snort
 bin/u2boat
 bin/u2spewfoo
@@ -34,81 +34,6 @@
 @unexec if cmp  -s %D/etc/snort/file_magic.conf-sample %D/etc/snort/file_magic.conf; then rm -f %D/etc/snort/file_magic.conf; fi
 etc/snort/file_magic.conf-sample
 @exec if [ ! -f %D/etc/snort/file_magic.conf ] ; then cp -p %D/%F %B/file_magic.conf; fi
-include/snort/dynamic_output/bitop.h
-include/snort/dynamic_output/ipv6_port.h
-include/snort/dynamic_output/obfuscation.h
-include/snort/dynamic_output/output_api.h
-include/snort/dynamic_output/output_common.h
-include/snort/dynamic_output/output_lib.h
-include/snort/dynamic_output/preprocids.h
-include/snort/dynamic_output/sfPolicy.h
-include/snort/dynamic_output/sf_dynamic_common.h
-include/snort/dynamic_output/sf_ip.h
-include/snort/dynamic_output/sf_protocols.h
-include/snort/dynamic_output/sf_snort_packet.h
-include/snort/dynamic_output/sfrt.h
-include/snort/dynamic_output/sfrt_dir.h
-include/snort/dynamic_output/sfrt_trie.h
-include/snort/dynamic_output/snort_debug.h
-include/snort/dynamic_output/stream_api.h
-%%APPID%%include/snort/dynamic_preproc/md5.h
-%%APPID%%include/snort/dynamic_preproc/sfghash.h
-%%APPID%%include/snort/dynamic_preproc/sfhashfcn.h
-%%APPID%%include/snort/dynamic_preproc/sflsq.h
-%%APPID%%include/snort/dynamic_preproc/sfmemcap.h
-%%APPID%%include/snort/dynamic_preproc/sfprimetable.h
-%%APPID%%include/snort/dynamic_preproc/sfxhash.h
-include/snort/dynamic_preproc/appId.h
-include/snort/dynamic_preproc/bitop.h
-include/snort/dynamic_preproc/cpuclock.h
-include/snort/dynamic_preproc/file_api.h
-include/snort/dynamic_preproc/file_mail_common.h
-include/snort/dynamic_preproc/idle_processing.h
-include/snort/dynamic_preproc/ipv6_port.h
-include/snort/dynamic_preproc/mempool.h
-include/snort/dynamic_preproc/mpse_methods.h
-include/snort/dynamic_preproc/obfuscation.h
-include/snort/dynamic_preproc/packet_time.h
-include/snort/dynamic_preproc/preprocids.h
-include/snort/dynamic_preproc/profiler.h
-include/snort/dynamic_preproc/segment_mem.h
-include/snort/dynamic_preproc/session_api.h
-include/snort/dynamic_preproc/sfPolicy.h
-include/snort/dynamic_preproc/sfPolicyUserData.h
-include/snort/dynamic_preproc/sf_decompression.h
-include/snort/dynamic_preproc/sf_dynamic_common.h
-include/snort/dynamic_preproc/sf_dynamic_define.h
-include/snort/dynamic_preproc/sf_dynamic_engine.h
-include/snort/dynamic_preproc/sf_dynamic_meta.h
-include/snort/dynamic_preproc/sf_dynamic_preproc_lib.h
-include/snort/dynamic_preproc/sf_dynamic_preprocessor.h
-include/snort/dynamic_preproc/sf_ip.h
-include/snort/dynamic_preproc/sf_preproc_info.h
-include/snort/dynamic_preproc/sf_protocols.h
-include/snort/dynamic_preproc/sf_sdlist_types.h
-include/snort/dynamic_preproc/sf_seqnums.h
-include/snort/dynamic_preproc/sf_snort_packet.h
-include/snort/dynamic_preproc/sf_snort_plugin_api.h
-include/snort/dynamic_preproc/sfcommon.h
-include/snort/dynamic_preproc/sfcontrol.h
-include/snort/dynamic_preproc/sfdebug.h
-include/snort/dynamic_preproc/sfrt.h
-include/snort/dynamic_preproc/sfrt_dir.h
-include/snort/dynamic_preproc/sfrt_flat.h
-include/snort/dynamic_preproc/sfrt_flat_dir.h
-include/snort/dynamic_preproc/sfrt_trie.h
-include/snort/dynamic_preproc/sidechannel_define.h
-include/snort/dynamic_preproc/sip_common.h
-include/snort/dynamic_preproc/snort_bounds.h
-include/snort/dynamic_preproc/snort_debug.h
-include/snort/dynamic_preproc/ssl.h
-include/snort/dynamic_preproc/ssl_config.h
-include/snort/dynamic_preproc/ssl_ha.h
-include/snort/dynamic_preproc/ssl_include.h
-include/snort/dynamic_preproc/ssl_inspect.h
-include/snort/dynamic_preproc/ssl_session.h
-include/snort/dynamic_preproc/str_search.h
-include/snort/dynamic_preproc/stream_api.h
 lib/snort/dynamic_output/libsf_dynamic_output.a
 lib/snort/dynamic_preproc/libsf_dynamic_preproc.a
 lib/snort_dynamicengine/libsf_engine.a
@@ -182,147 +107,12 @@
 libdata/pkgconfig/snort.pc
 libdata/pkgconfig/snort_output.pc
 libdata/pkgconfig/snort_preproc.pc
-man/man8/snort.8.gz
-%%PORTDOCS%%%%DOCSDIR%%/AUTHORS
-%%PORTDOCS%%%%DOCSDIR%%/BUGS
-%%PORTDOCS%%%%DOCSDIR%%/CREDITS
-%%PORTDOCS%%%%DOCSDIR%%/INSTALL
-%%PORTDOCS%%%%DOCSDIR%%/NEWS
-%%PORTDOCS%%%%DOCSDIR%%/OpenDetectorDeveloperGuide.pdf
-%%PORTDOCS%%%%DOCSDIR%%/PROBLEMS
-%%PORTDOCS%%%%DOCSDIR%%/README
-%%PORTDOCS%%%%DOCSDIR%%/README.GTP
-%%PORTDOCS%%%%DOCSDIR%%/README.PLUGINS
-%%PORTDOCS%%%%DOCSDIR%%/README.PerfProfiling
-%%PORTDOCS%%%%DOCSDIR%%/README.SMTP
-%%PORTDOCS%%%%DOCSDIR%%/README.UNSOCK
-%%PORTDOCS%%%%DOCSDIR%%/README.WIN32
-%%PORTDOCS%%%%DOCSDIR%%/README.active
-%%PORTDOCS%%%%DOCSDIR%%/README.alert_order
-%%PORTDOCS%%%%DOCSDIR%%/README.appid
-%%PORTDOCS%%%%DOCSDIR%%/README.asn1
-%%PORTDOCS%%%%DOCSDIR%%/README.counts
-%%PORTDOCS%%%%DOCSDIR%%/README.csv
-%%PORTDOCS%%%%DOCSDIR%%/README.daq
-%%PORTDOCS%%%%DOCSDIR%%/README.dcerpc2
-%%PORTDOCS%%%%DOCSDIR%%/README.decode
-%%PORTDOCS%%%%DOCSDIR%%/README.decoder_preproc_rules
-%%PORTDOCS%%%%DOCSDIR%%/README.dnp3
-%%PORTDOCS%%%%DOCSDIR%%/README.dns
-%%PORTDOCS%%%%DOCSDIR%%/README.event_queue
-%%PORTDOCS%%%%DOCSDIR%%/README.file
-%%PORTDOCS%%%%DOCSDIR%%/README.file_ips
-%%FILEINSPECT%%%%PORTDOCS%%%%DOCSDIR%%/README.file_server
-%%PORTDOCS%%%%DOCSDIR%%/README.filters
-%%PORTDOCS%%%%DOCSDIR%%/README.flowbits
-%%PORTDOCS%%%%DOCSDIR%%/README.frag3
-%%PORTDOCS%%%%DOCSDIR%%/README.ftptelnet
-%%PORTDOCS%%%%DOCSDIR%%/README.gre
-%%PORTDOCS%%%%DOCSDIR%%/README.ha
-%%PORTDOCS%%%%DOCSDIR%%/README.http_inspect
-%%PORTDOCS%%%%DOCSDIR%%/README.imap
-%%PORTDOCS%%%%DOCSDIR%%/README.ipip
-%%PORTDOCS%%%%DOCSDIR%%/README.ipv6
-%%PORTDOCS%%%%DOCSDIR%%/README.modbus
-%%PORTDOCS%%%%DOCSDIR%%/README.multipleconfigs
-%%PORTDOCS%%%%DOCSDIR%%/README.normalize
-%%PORTDOCS%%%%DOCSDIR%%/README.pcap_readmode
-%%PORTDOCS%%%%DOCSDIR%%/README.pop
-%%PORTDOCS%%%%DOCSDIR%%/README.ppm
-%%PORTDOCS%%%%DOCSDIR%%/README.reload
-%%PORTDOCS%%%%DOCSDIR%%/README.reputation
-%%PORTDOCS%%%%DOCSDIR%%/README.sensitive_data
-%%PORTDOCS%%%%DOCSDIR%%/README.sfportscan
-%%PORTDOCS%%%%DOCSDIR%%/README.sip
-%%PORTDOCS%%%%DOCSDIR%%/README.ssh
-%%PORTDOCS%%%%DOCSDIR%%/README.ssl
-%%PORTDOCS%%%%DOCSDIR%%/README.stream5
-%%PORTDOCS%%%%DOCSDIR%%/README.tag
-%%PORTDOCS%%%%DOCSDIR%%/README.thresholding
-%%PORTDOCS%%%%DOCSDIR%%/README.u2boat
-%%PORTDOCS%%%%DOCSDIR%%/README.unified2
-%%PORTDOCS%%%%DOCSDIR%%/README.variables
-%%PORTDOCS%%%%DOCSDIR%%/RELEASE.NOTES
-%%PORTDOCS%%%%DOCSDIR%%/TODO
-%%PORTDOCS%%%%DOCSDIR%%/USAGE
-%%PORTDOCS%%%%DOCSDIR%%/WISHLIST
-%%PORTDOCS%%%%DOCSDIR%%/generators
-%%PORTDOCS%%%%DOCSDIR%%/snort_manual.pdf
-%%APPID%%src/snort_dynamicsrc/md5.h
-%%APPID%%src/snort_dynamicsrc/sfmemcap.h
-%%APPID%%src/snort_dynamicsrc/sfprimetable.h
-%%APPID%%src/snort_dynamicsrc/sfxhash.h
-src/snort_dynamicsrc/Unified2_common.h
-src/snort_dynamicsrc/appId.h
-src/snort_dynamicsrc/bitop.h
-src/snort_dynamicsrc/event.h
-src/snort_dynamicsrc/file_api.h
-src/snort_dynamicsrc/file_mail_common.h
-src/snort_dynamicsrc/idle_processing.h
-src/snort_dynamicsrc/mpse_methods.h
-src/snort_dynamicsrc/obfuscation.h
-src/snort_dynamicsrc/pcap_pkthdr32.h
-src/snort_dynamicsrc/plugin_enum.h
-src/snort_dynamicsrc/preprocids.h
-src/snort_dynamicsrc/profiler.h
-src/snort_dynamicsrc/rule_option_types.h
-src/snort_dynamicsrc/session_api.h
-src/snort_dynamicsrc/sfPolicyUserData.c
-src/snort_dynamicsrc/sfPolicyUserData.h
-src/snort_dynamicsrc/sf_base64decode.c
-src/snort_dynamicsrc/sf_base64decode.h
-src/snort_dynamicsrc/sf_decompression.h
-src/snort_dynamicsrc/sf_dynamic_common.h
-src/snort_dynamicsrc/sf_dynamic_define.h
-src/snort_dynamicsrc/sf_dynamic_engine.h
-src/snort_dynamicsrc/sf_dynamic_meta.h
-src/snort_dynamicsrc/sf_dynamic_preproc_lib.c
-src/snort_dynamicsrc/sf_dynamic_preproc_lib.h
-src/snort_dynamicsrc/sf_dynamic_preprocessor.h
-src/snort_dynamicsrc/sf_email_attach_decode.c
-src/snort_dynamicsrc/sf_email_attach_decode.h
-src/snort_dynamicsrc/sf_ip.h
-src/snort_dynamicsrc/sf_protocols.h
-src/snort_dynamicsrc/sf_seqnums.h
-src/snort_dynamicsrc/sf_snort_packet.h
-src/snort_dynamicsrc/sf_snort_plugin_api.h
-src/snort_dynamicsrc/sf_types.h
-src/snort_dynamicsrc/sfcontrol.h
-src/snort_dynamicsrc/sfdebug.h
-src/snort_dynamicsrc/sfghash.h
-src/snort_dynamicsrc/sfhashfcn.h
-src/snort_dynamicsrc/sfparser.c
-src/snort_dynamicsrc/sfsnort_dynamic_detection_lib.c
-src/snort_dynamicsrc/sfsnort_dynamic_detection_lib.h
-src/snort_dynamicsrc/sidechannel_define.h
-src/snort_dynamicsrc/signature.h
-src/snort_dynamicsrc/sip_common.h
-src/snort_dynamicsrc/snort_debug.h
-src/snort_dynamicsrc/ssl.c
-src/snort_dynamicsrc/ssl.h
-src/snort_dynamicsrc/ssl_config.c
-src/snort_dynamicsrc/ssl_config.h
-src/snort_dynamicsrc/ssl_ha.c
-src/snort_dynamicsrc/ssl_ha.h
-src/snort_dynamicsrc/ssl_include.h
-src/snort_dynamicsrc/ssl_inspect.c
-src/snort_dynamicsrc/ssl_inspect.h
-src/snort_dynamicsrc/ssl_session.h
-src/snort_dynamicsrc/str_search.h
-src/snort_dynamicsrc/stream_api.h
-src/snort_dynamicsrc/treenodes.h
-src/snort_dynamicsrc/util_unfold.c
-src/snort_dynamicsrc/util_unfold.h
-@unexec rmdir "/var/log/snort" >/dev/null 2>&1 || :
-@dir src/snort_dynamicsrc
-@dir src
-%%PORTDOCS%%@dir %%DOCSDIR%%
-@dir lib/snort/dynamic_preproc
-@dir lib/snort/dynamic_output
-@dir lib/snort
-@dir include/snort/dynamic_preproc
-@dir include/snort/dynamic_output
-@dir include/snort
-@dir etc/snort/rules
-@dir etc/snort/preproc_rules
-@dir etc/snort
+@unexec rmdir >/dev/null 2>&1 /var/log/snort || :
+@dirrmtry lib/snort/dynamic_preproc
+@dirrmtry lib/snort/dynamic_output
+@dirrmtry lib/snort
+@dirrmtry lib/snort_dynamicpreprocessor
+@dirrmtry lib/snort_dynamicengine
+@dirrmtry etc/snort/rules
+@dirrmtry etc/snort/preproc_rules
+@dirrmtry etc/snort
